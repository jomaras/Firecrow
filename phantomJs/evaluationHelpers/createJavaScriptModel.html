<!DOCTYPE html>
<html>
<head>
    <title>JavaScript Model Generator</title>
    <script src="esprima.js"></script>
    <script src="escodegen.js"></script>
    <style>
        textarea
        {
            width: 49%;
            min-height: 600px;
        }
    </style>
    <script>
        window.QueryString = (function(a) {
            if (a == "") return {};
            var b = {};
            for (var i = 0; i < a.length; ++i)
            {
                var p=a[i].split('=');
                if (p.length != 2) continue;
                b[p[0]] = decodeURIComponent(p[1].replace(/\+/g, " "));
            }
            return b;
        })(window.location.search.substr(1).split('&'));
    </script>
    <script>
        var pageUrl = window.QueryString["url"];
        var urlSource = "";

        if(pageUrl)
        {
            var xmlHttpRequest = new XMLHttpRequest();

            xmlHttpRequest.open("GET", pageUrl, false);
            xmlHttpRequest.send();

            urlSource = xmlHttpRequest.responseText;
        }
        else
        {
            alert("No page url");
        }
    </script>
</head>
<body>
    <textarea id="sourceContainer"></textarea>
    <textarea id="astContainer"></textarea>

    <script>
        var sourceContainer = document.getElementById("sourceContainer");
        var astContainer = document.getElementById("astContainer");

        sourceContainer.textContent = urlSource;

        var urlSourceModel = esprima.parse(urlSource, {loc:true});

        astContainer.textContent = JSON.stringify(urlSourceModel);
    </script>
</body>
</html>