<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8">
    <script src="../mootools-core.js"></script>
</head>
<body>
    <script>
        var Animal = new Class({
            initialized: false,
            initialize: function(name, sound){
                this.name = name;
                this.sound = sound || '';
                this.initialized = true;
            },
            eat: function(){ return 'animal:eat:' + this.name; },
            say: function(){ return 'animal:say:' + this.name;}
        });

        var Cat = new Class({
            Extends: Animal,
            ferocious: false,
            initialize: function(name, sound){ this.parent(name, sound || 'miao');},
            eat: function(){ return 'cat:eat:' + this.name; },
            play: function(){ return 'cat:play:' + this.name; }
        });

        var Lion = new Class({
            Extends: Cat,
            ferocious: true,
            initialize: function(name){ this.parent(name, 'rarr'); },
            eat: function(){ return 'lion:eat:' + this.name; }
        });

        var Actions = new Class({
            jump: function(){ return 'actions:jump:' + this.name; },
            sleep: function(){ return 'actions:sleep:' + this.name; }
        });

        var Attributes = new Class({
            color: function(){ return 'attributes:color:' + this.name; },
            size: function(){ return 'attributes:size:' + this.name; }
        });

        assertEquals($type(Animal), 'class');
        assertEquals(Class.type(Animal), true);

        var animal = new Animal('lamina');
        assertEquals(animal.name, 'lamina');
        assertEquals(animal.initialized, true);
        assertEquals(animal.say(), 'animal:say:lamina');

        var cat = new Cat('fluffy');
        assertEquals(cat.name, 'fluffy');
        assertEquals(cat.sound, 'miao');
        assertEquals(cat.ferocious, false);
        assertEquals(cat.say(), 'animal:say:fluffy');
        assertEquals(cat.eat(), 'cat:eat:fluffy');
        assertEquals(cat.play(), 'cat:play:fluffy');

        var leo = new Lion('leo');
        assertEquals(leo.name, 'leo');
        assertEquals(leo.sound, 'rarr');
        assertEquals(leo.ferocious, true);
        assertEquals(leo.say(), 'animal:say:leo');
        assertEquals(leo.eat(), 'lion:eat:leo');
        assertEquals(leo.play(), 'cat:play:leo');

        var Dog = new Class({
            Implements: Animal
        });

        var rover = new Dog('rover');
        assertEquals(rover.name, 'rover');
        assertEquals(rover.initialized, true);
        assertEquals(rover.eat(), 'animal:eat:rover');

        Dog = new Class({
            Extends: Animal,
            Implements: [Actions, Attributes]
        });

        var rover = new Dog('rover');
        assertEquals(rover.initialized, true);
        assertEquals(rover.eat(), 'animal:eat:rover');
        assertEquals(rover.say(), 'animal:say:rover');
        assertEquals(rover.jump(), 'actions:jump:rover');
        assertEquals(rover.sleep(), 'actions:sleep:rover');
        assertEquals(rover.size(), 'attributes:size:rover');
        assertEquals(rover.color(), 'attributes:color:rover');

        Dog = new Class({
            Extends: Animal
        });

        var rover = new Dog('rover');

        Dog.implement({
            jump: function(){
                return 'dog:jump:' + this.name;
            }
        });

        var spot = new Dog('spot');

        assertEquals(spot.jump(), 'dog:jump:spot');
        assertEquals(rover.jump(), 'dog:jump:rover');

        Dog = new Class({
            Extends: Animal
        });

        var rover = new Dog('rover');

        Animal.implement({
            jump: function(){
                return 'animal:jump:' + this.name;
            }
        });

         var spot = new Dog('spot');

         assertEquals(spot.jump(), 'animal:jump:spot');
         assertEquals(rover.jump(), 'animal:jump:rover');

        Dog = new Class({
            Extends: Animal
        });

        var rover = new Dog('rover');
        assertEquals(rover.say(), 'animal:say:rover');

        Animal.implement({
            say: function(){
                return 'NEW:animal:say:' + this.name;
            }
        });

        var spot = new Dog('spot');

        assertEquals(spot.say(), 'NEW:animal:say:spot');
        assertEquals(rover.say(), 'NEW:animal:say:rover');
    </script>
</body>
</html>