<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script src="http://localhost/Firecrow/evaluation/libraries/prototype/prototype.js"></script>
    <script src="http://localhost/Firecrow/evaluation/libraries/prototype/hash.js"></script>
</head>
<body>
      <script>
      var h =  $H({'a#': 'A'});
          assertEquals('',                   $H({}).toQueryString());
          assertEquals('a%23=A',            h.toQueryString());
          assertEquals('a=A%23',             $H(Fixtures.one).toQueryString());
          assertEquals('a=A&b=B&c=C&d=D%23', $H(Fixtures.many).toQueryString());
          assertEquals("a=b&c",              $H(Fixtures.value_undefined).toQueryString());
          assertEquals("a=b&c",              $H("a=b&c".toQueryParams()).toQueryString());
          assertEquals("a=b%2Bd&c",            $H("a=b+d&c".toQueryParams()).toQueryString());
          assertEquals("a=b&c=",             $H(Fixtures.value_null).toQueryString());
          assertEquals("a=b&c=0",            $H(Fixtures.value_zero).toQueryString());
          assertEquals("color=r&color=g&color=b", $H(Fixtures.multiple).toQueryString());
          assertEquals("color=r&color=&color=g&color&color=0", $H(Fixtures.multiple_nil).toQueryString());
          assertEquals("color=&color",       $H(Fixtures.multiple_all_nil).toQueryString());
          assertEquals("",                   $H(Fixtures.multiple_empty).toQueryString());
          assertEquals("",                   $H({foo: {}, bar: {}}).toQueryString());
          assertEquals("stuff%5B%5D=%24&stuff%5B%5D=a&stuff%5B%5D=%3B", $H(Fixtures.multiple_special).toQueryString());
          assertEquals(Object.toQueryString, Hash.toQueryString);

          // Serializing newlines and spaces is weird. See:
          // http://www.w3.org/TR/1999/REC-html401-19991224/interact/forms.html#h-17.13.4.1
          var complex = "an arbitrary line\n\'something in single quotes followed by a newline\'\r\n" +
                  "and more text eventually";
          var queryString = $H({ val: complex }).toQueryString();
          var expected = "val=an+arbitrary+line%0D%0A'something+in+single+quotes+followed+by+a+" +
                  "newline'%0D%0Aand+more+text+eventually";
          assertEquals(expected, queryString, "newlines and spaces should be properly encoded");
      </script>
</body>
</html>