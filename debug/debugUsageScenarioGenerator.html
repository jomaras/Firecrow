<!DOCTYPE html>
<html>
<head>
    <title>Usage Scenario Generator</title>
    <meta charset="UTF-8"/>
    <script>
        var FBL = undefined;
    </script>
    <script src="../chrome/content/Firecrow/initFBL.js"></script>
    <script src="usageScenarioGenerator/modelMapping.js"></script>
    <script src="../chrome/content/Firecrow/parsers/CssSelectorParser.js"></script>
    <script src="../chrome/content/Firecrow/helpers/valueTypeHelper.js"></script>
    <script src="../chrome/content/Firecrow/helpers/htmlHelper.js"></script>
    <script src="../chrome/content/Firecrow/helpers/RequestHelper.js"></script>
    <script src="../chrome/content/Firecrow/helpers/ASTHelper.js"></script>
    <script src="../chrome/content/Firecrow/helpers/htmlHelper.js"></script>
    <script src="../chrome/content/Firecrow/helpers/UriHelper.js"></script>
    <script src="../chrome/content/Firecrow/helpers/TimerHelper.js"></script>

    <script src="../chrome/content/Firecrow/scenarioGenerator/Event.js"></script>
    <script src="../chrome/content/Firecrow/scenarioGenerator/Scenario.js"></script>
    <script src="../chrome/content/Firecrow/scenarioGenerator/ScenarioCollection.js"></script>
    <script src="../chrome/content/Firecrow/scenarioGenerator/ScenarioBrowserHelper.js"></script>
    <script src="../chrome/content/Firecrow/scenarioGenerator/ScenarioGenerator.js"></script>
    <script src="../chrome/content/Firecrow/scenarioGenerator/SeleniumCodeGenerator.js"></script>

    <script src="../chrome/content/Firecrow/scenarioGenerator/symbolic/NumberRange.js"></script>
    <script src="../chrome/content/Firecrow/scenarioGenerator/symbolic/StringConstraint.js"></script>
    <script src="../chrome/content/Firecrow/scenarioGenerator/symbolic/Expression.js"></script>
    <script src="../chrome/content/Firecrow/scenarioGenerator/symbolic/PathConstraint.js"></script>
    <script src="../chrome/content/Firecrow/scenarioGenerator/symbolic/SymbolicExecutor.js"></script>
    <script src="../chrome/content/Firecrow/scenarioGenerator/symbolic/ConstraintResolver.js"></script>

    <script src="../chrome/content/Firecrow/dependencyGraph/node.js"></script>
    <script src="../chrome/content/Firecrow/dependencyGraph/edge.js"></script>
    <script src="../chrome/content/Firecrow/dependencyGraph/dependencyGraph.js"></script>
    <script src="../chrome/content/Firecrow/dependencyGraph/slicingCriterion.js"></script>
    <script src="../chrome/content/Firecrow/dependencyGraph/inclusionFinder.js"></script>
    <script src="../chrome/content/Firecrow/dependencyGraph/dependencyPostprocessor.js"></script>
    <script src="../chrome/content/Firecrow/codeMarkupGenerator/codeMarkupGenerator.js"></script>
    <script src="../chrome/content/Firecrow/codeMarkupGenerator/codeTextGenerator.js"></script>

    <script src="../chrome/content/Firecrow/interpreter/commands/CommandGenerator.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/commands/Command.js"></script>

    <script src="../chrome/content/Firecrow/interpreter/model/FcValue.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/object/Object.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/object/ObjectPrototype.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/object/ObjectFunction.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/object/ObjectExecutor.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/globalObject/GlobalObject.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/globalObject/GlobalObjectExecutor.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/array/Array.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/array/ArrayCallbackExecutor.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/array/ArrayExecutor.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/array/ArrayFunction.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/array/ArrayPrototype.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/XMLHttpRequest.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/Math.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/internal/RegEx.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/Function.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/Identifier.js"></script>

    <script src="../chrome/content/Firecrow/interpreter/model/internal/FunctionFunction.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/internal/Boolean.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/internal/Date.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/internal/Number.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/internal/String.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/internal/Image.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/internal/Element.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/internal/HTMLElement.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/internal/HTMLImageElement.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/internal/Canvas.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/internal/Error.js"></script>

    <script src="../chrome/content/Firecrow/interpreter/model/DOM/Document.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/DOM/DocumentExecutor.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/DOM/HtmlElement.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/DOM/HtmlElementExecutor.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/DOM/TextNode.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/DOM/Attribute.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/DOM/ClassList.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/DOM/CSSStyleDeclaration.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/DOM/DOMProperties.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/DOM/SimpleXPath.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/DOM/EventListenerMixin.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/model/DOM/Event.js"></script>

    <script src="../chrome/content/Firecrow/interpreter/simulator/VariableObject.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/simulator/InternalExecutor.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/simulator/ExecutionContextStack.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/simulator/DependencyCreator.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/simulator/Evaluator.js"></script>


    <script src="../chrome/content/Firecrow/interpreter/InterpreterSimulator.js"></script>

    <script src="../chrome/content/Firecrow/doppelBrowser/browser.js"></script>
    <script src="../chrome/content/Firecrow/interpreter/ExecutionInfo.js"></script>
    <script src="../chrome/content/Firecrow/dependencyGraph/DependencyGenerator.js"></script>
    <script src="../chrome/content/Firecrow/Slicer.js"></script>
    <script src="../chrome/content/Firecrow/Reuser.js"></script>
    <script src="../chrome/content/Firecrow/templates/reuserTemplates.js"></script>

    <link href="style/codeColoring.css" rel="stylesheet" type="text/css">

    <style>
        #pageCodeContainer
        {
            line-height: normal;
            font-size: 10pt;
            margin: 5px;
            margin-top: 17px;
            width: 49%;
        }

        #scenarioContainer
        {
            width: 49%;
        }

        .reportContainer
        {
            float: left;
            margin: 5px;
            height: 400px;
            overflow: auto;
        }

        .panel
        {
            background: #f2f2f2;
            border: solid 1px #e6e6e6;
            padding: 10px;
        }

        #executedScenarioTracesContainer,
        #keptScenarioTracesContainer
        {
            width: 400px;
            margin: 5px;
        }

        iframe
        {
            margin: 0;
            border: none;
        }

        .selected { background-color: green; }
        .dependent { background-color: yellow; }
        .secondHandDependencies { background-color: #7FFF00;}
        .unexecuted { color: gray;}
        .executed { color: black;}

        .scenarioHeader { color: blue; font-weight: bold; }
        .formulaHeader { color: red; font-weight: bold; }

        .script.node > .node.htmlTag, .style.node > .node.htmlTag { cursor: pointer;}
        body{ margin: 0; padding: 0;}

        #topBar
        {
            background: #222;
            min-height: 45px;
            line-height: 45px;
            padding: 0;
            width: 100%;
            position: relative;
        }

        .titleSpan
        {
            color: white;
            font-size: 13pt;
            padding-left: 10px;
        }

        #frameContainer
        {
            width: 98%;
            margin: 10px;
        }

        ul.tabsContent
        {
            display: block;
            margin: 0 0 20px;
            padding: 0;
            list-style: none;
            overflow: auto;
            font-size: 11pt;
        }

        ul.tabsContent>li.activeTab
        {
            display: block;
        }

        ul.tabsContent>li
        {
            display: none;
        }

        .tabs
        {
            list-style: none;
            border-bottom: solid 1px #e6e6e6;
            display: block;
            height: 40px;
            padding: 0;
        }

        .tabs dd:first-child, .tabs li:first-child
        {
            margin-left: 0;
        }

        .tabs dd.activeTab, .tabs li.activeTab
        {
            border-top: 3px solid #2ba6cb;
            margin-top: -2px;
        }

        .tabs dd, .tabs li
        {
            display: block;
            float: left;
            padding: 0;
            margin: 0;
        }

        .tabs dd.activeTab a, .tabs li.activeTab a {
            cursor: default;
            color: #3c3c3c;
            background: #fff;
            border-left: 1px solid #e6e6e6;
            border-right: 1px solid #e6e6e6;
            font-weight: bold;
        }
        .tabs dd a, .tabs li a {
            color: #6f6f6f;
            display: block;
            font-size: 12px;
            height: 40px;
            line-height: 40px;
            padding: 0px 10px;
        }

        .myButton.radius {
            -webkit-border-radius: 3px;
            -moz-border-radius: 3px;
            -ms-border-radius: 3px;
            -o-border-radius: 3px;
            border-radius: 3px;
        }

        .myButton.medium {
            font-size: 14px;
        }

        .myButton {
            width: auto;
            background: #2ba6cb;
            border: 1px solid #1e728c;
            -webkit-box-shadow: 0 1px 0 rgba(255,255,255,0.5) inset;
            -moz-box-shadow: 0 1px 0 rgba(255,255,255,0.5) inset;
            box-shadow: 0 1px 0 rgba(255,255,255,0.5) inset;
            color: #fff;
            cursor: pointer;
            display: inline-block;
            font-family: inherit;
            font-size: 14px;
            font-weight: bold;
            line-height: 1;
            margin: 0;
            padding: 8px 20px 8px;
            position: relative;
            text-align: center;
            text-decoration: none;
            -webkit-transition: background-color 0.15s ease-in-out;
            -moz-transition: background-color 0.15s ease-in-out;
            -o-transition: background-color 0.15s ease-in-out;
            transition: background-color 0.15s ease-in-out;
        }

        .right { float: right; }
        .left { float: left; }

        #scriptPathInputs label { margin: 5px;}
    </style>
</head>
<body>
    <div id="topBar">
        <span class="titleSpan">Firecrow - Debugging Usage Scenario Generator</span>
        <input class="medium radius myButton right" type="button" value="Run" id="runButton" style="margin: 5px;">
    </div>

    <div class="panel">
        <div>Measure coverage of: </div>
        <div id="scriptPathInputs">
        </div>
    </div>

    <div style="width:1200px; margin-left: auto; margin-right: auto;">
        <div class="reportContainer" id="pageCodeContainer"></div>
        <div class="reportContainer" id="scenarioContainer">
            <dl class="tabs">
                <dd id="showAllScenariosTab" class="activeTab"><a href="#">All Scenarios</a></dd>
                <dd id="showKeptScenariosTab" class=""><a href="#">Kept Scenarios</a></dd>
                <dd id="showSeleniumCodeTab" class=""><a href="#">Selenium Code</a></dd>
            </dl>

            <ul class="tabsContent">
                <li id="tabAllScenarios" class="activeTab">
                    <h2 id="executedScenariosTitle">Executed scenarios: </h2>
                    <h4 id="elapsedTimeTitle"></h4>
                    <div style="font-weight: bolder;">
                        <div id="statementCoverageTitle"></div>
                        <div id="branchCoverageTitle"></div>
                    </div>
                    <hr/>
                    <div id="executedScenarioTracesContainer"></div>
                </li>
                <li id="tabKeptScenarios">
                    <h2 id="keptScenarioTitle">Kept scenarios: </h2>
                    <div id="keptScenarioTracesContainer">
                    </div>
                </li>
                <li id="tabSeleniumCode">
                    <pre id="seleniumCodeContainer"></pre>
                </li>
            </ul>
        </div>
        <br/>
        <div style="clear:both"></div>
        <hr style="margin: 10px"/>
        <div id="frameContainer">
            <h2>Rendered page</h2>
            <iframe id="firecrowFrame" height="100%" width="100%" style="overflow:auto;"></iframe>
        </div>
    </div>
    <!--<script src="usageScenarioGenerator/fullPages/original/snake/modelMapping.js"></script>-->
    <!--<script src="usageScenarioGenerator/fullPages/original/snake/modelMapping.js"></script>-->
    <!--<script src="usageScenarioGenerator/fullPages/original/ticTacToeCase/modelMapping.js"></script>-->
    <!--<script src="usageScenarioGenerator/fullPages/evaluationApplications/3dmodel/modelMapping.js"></script>-->
    <!--<script src="usageScenarioGenerator/fullPages/simplified/jQueryAjax/1-okasync/modelMapping.js"></script>-->
    <!--<script src="usageScenarioGenerator/fullPages/simplified/externalResources/model.json"></script>-->
    <!--<script src="usageScenarioGenerator/fullPages/evaluationApplications/rentingAgency/"></script>-->
    <script src="usageScenarioGenerator/06/index.json"></script>

    <script type="text/javascript">
        //TODO - test 37 is not executed twice
        //6- does not cover everything, gets stuck extending
        //var model = models[44];
        var model = {pageModel: fullPageModel};
        var uiControlsSelectors = model.uiControlsSelectors || ["*"];

        var pageCodeContainer = document.getElementById("pageCodeContainer");
        var executedScenarioTracesContainer = document.getElementById("executedScenarioTracesContainer");
        var keptScenarioTracesContainer = document.getElementById("keptScenarioTracesContainer");
        var executedScenarioTitle = document.getElementById("executedScenariosTitle");
        var keptScenarioTitle = document.getElementById("keptScenarioTitle");
        var elapsedTimeTitle = document.getElementById("elapsedTimeTitle");
        var statementCoverageTitle = document.getElementById("statementCoverageTitle");
        var branchCoverageTitle = document.getElementById("branchCoverageTitle");
        var scriptPathInputs = document.getElementById("scriptPathInputs");
        var runButton = document.getElementById("runButton");

        var scenarioInfoContainer = executedScenarioTracesContainer;

        pageCodeContainer.innerHTML = FBL.Firecrow.CodeMarkupGenerator.generateHtmlRepresentation(model.pageModel);
        handleScriptAndStyleNodeMinimize();

        (function createExternalScriptCheckboxes()
        {
            FBL.Firecrow.ASTHelper.getScriptElements(model.pageModel.htmlElement).filter(function(scriptElement)
            {
                var src = FBL.Firecrow.ASTHelper.getAttributeValue(scriptElement, "src");
                if(src != null && src != "")
                {
                    var inputElement = document.createElement("input");
                    var labelElement = document.createElement("label");

                    inputElement.scriptSrc = src;
                    inputElement.type = "checkbox";
                    inputElement.checked = true;

                    var startIndex = src.lastIndexOf("/");
                    if(startIndex == -1) { startIndex = src.lastIndexOf("\\"); }
                    if(startIndex == -1) { startIndex = 0; }

                    labelElement.appendChild(inputElement);
                    labelElement.appendChild(document.createTextNode(src.substring(startIndex, src.length))) ;

                    scriptPathInputs.appendChild(labelElement);
                }
            });
        })();

        var scenarioCounter = 0;
        var scGenerator = FBL.Firecrow.ScenarioGenerator;

        runButton.onclick = function()
        {
            var timer = new FBL.Firecrow.TimerHelper.createTimer();
            var lastTime = 0;
            scenarioCounter = 0;

            scenarioInfoContainer.innerHTML = "";

            document.getElementById("seleniumCodeContainer").textContent = "";
            document.title = "Scenario Generator";
            executedScenarioTitle.textContent = "Executed scenarios: ";
            keptScenarioTitle.textContent = "Kept scenarios: ";
            elapsedTimeTitle.textContent = "";
            statementCoverageTitle.textContent = "";
            branchCoverageTitle.textContent = "";
            executedScenarioTracesContainer.innerHTML = "";
            keptScenarioTracesContainer.innerHTML = "";

            scGenerator.ScenarioGenerator.generateScenarios
            (
                model.pageModel,
                uiControlsSelectors,
                function(scenario)
                {
                    elapsedTimeTitle.textContent = scenarioCounter
                            + " - Time: " + timer.getElapsedTimeInSeconds()
                            + " sec; Delta: " + (timer.getElapsedTimeInSeconds() - lastTime) + " sec"
                            + " Coverage: " + scGenerator.ScenarioGenerator.achievedCoverage;
                    lastTime = timer.getElapsedTimeInSeconds();
                    document.title = scenarioCounter + "/" + scGenerator.ScenarioGenerator.scenarioProcessingLimit + " "
                            + "C:" + scGenerator.ScenarioGenerator.achievedCoverage.toString().substring(0, 4) + " "
                            + "T:" + (timer.getElapsedTimeInSeconds() - lastTime);

                    generateScenarioHtml(scenario);
                },

                function(usageScenarios)
                {
                    var coverage = FBL.Firecrow.ASTHelper.calculateCoverage(model.pageModel, getIgnoredExternalScripts());
                    executedScenarioTitle.innerHTML += scenarioCounter + " - <b style='color:red'>" + coverage.expressionCoverage *100  + "%</b>";
                    keptScenarioTitle.innerHTML += usageScenarios.length + " - <b style='color:red'>" + coverage.expressionCoverage *100 + "%</b>";
                    pageCodeContainer.innerHTML = FBL.Firecrow.CodeMarkupGenerator.generateHtmlRepresentation(model.pageModel);
                    handleScriptAndStyleNodeMinimize();
                    statementCoverageTitle.textContent = "Statement coverage: " + coverage.statementCoverage*100 + "% ";
                    branchCoverageTitle.textContent = "Branch coverage: " + coverage.branchCoverage*100 + "%";

                    scenarioCounter = 0;
                    scenarioInfoContainer = keptScenarioTracesContainer;

                    setTimeout(function()
                    {
                        usageScenarios.forEach(function(scenario)
                        {
                            generateScenarioHtml(scenario);
                        });

                        document.getElementById("seleniumCodeContainer").textContent = scGenerator.SeleniumCodeGenerator.generateCode(usageScenarios, model.pageModel.pageUrl);
                    }, 1000);

                    document.title += " Fin!";
                },
                getIgnoredExternalScripts()
            );
        };

        function getIgnoredExternalScripts()
        {
            var inputs = scriptPathInputs.querySelectorAll("input[type=checkbox]");

            var ignoredScripts = [];

            for(var i = 0; i < inputs.length; i++)
            {
                if(!inputs[i].checked && inputs[i].scriptSrc != "")
                {
                    ignoredScripts.push(inputs[i].scriptSrc);
                }
            }

            return ignoredScripts;
        }

        function generateScenarioHtml(scenario)
        {
            var resolvedResult = scenario.inputConstraint.resolvedResult;
            var html = "<div class='scenarioHeader'>Scenario " + scenarioCounter + " (id: " + scenario.id + ") " + (scenario.createdBy != null ? scenario.createdBy : "") +"</div>";
            var formulaString = scenario.inputConstraint != null ? (scenario.inputConstraint + " =&gt; " + JSON.stringify(resolvedResult))
                                                                 : "()";

            if(scenarioInfoContainer == executedScenarioTracesContainer)
            {
                html += "<div class='scenarioAchievedCoverageContainer'>Achieved Coverage: " + scGenerator.ScenarioGenerator.achievedCoverage  + "</div>";
                html += "<div class='scenarioTime'>" + elapsedTimeTitle.textContent  + "</div>";
            }

            html += "<div class='formulaHeader'>Formula: <b>" + formulaString  + "</div>";
            html += "<ol start='0'>";

            var events = scenario.events;

            for(var i = 0; i < events.length; i++)
            {
                var event = events[i];

                html += "<li>";
                html += event.toString() + " -&gt; " + JSON.stringify(resolvedResult[i]);
                html += "</li>";
            }

            html += "</ol><br/><br/>";

            var wrapper = document.createElement("div");
            wrapper.className = "scenarioWrapperContainer";
            wrapper.innerHTML = html;

            scenarioInfoContainer.appendChild(wrapper);

            //localStorage.setItem('lastGeneratedScenarioInfo', html);

            scenarioCounter++;
        }

        function handleScriptAndStyleNodeMinimize()
        {
            var scriptTags = pageCodeContainer.querySelectorAll(".script.node > .node.htmlTag");

            for(var i = 0; i < scriptTags.length; i++)
            {
                scriptTags[i].onclick = function()
                {
                    toggleScriptNodeVisibility(this);
                };
            }

            var styleTags = pageCodeContainer.querySelectorAll(".style.node > .node.htmlTag");

            for(var i = 0; i < styleTags.length; i++)
            {
                styleTags[i].onclick = function()
                {
                    toggleStyleNodeVisibility(this);
                };
            }
        }

        function toggleScriptNodeVisibility(scriptNode)
        {
            var jsContainer = scriptNode.parentElement.querySelector(".jsContainer");
            if(jsContainer.style.visibility == "collapse")
            {
                jsContainer.style.visibility = "visible";
                jsContainer.style.height = "auto";
            }
            else
            {
                jsContainer.style.visibility = "collapse";
                jsContainer.style.height = 0;
            }
        }

        function toggleStyleNodeVisibility(scriptNode)
        {
            var cssContainer = scriptNode.parentElement.querySelector(".cssContainer");
            if(cssContainer.style.visibility == "collapse")
            {
                cssContainer.style.visibility = "visible";
                cssContainer.style.height = "auto";
            }
            else
            {
                cssContainer.style.visibility = "collapse";
                cssContainer.style.height = 0;
            }
        }

        (function handleTabEvents()
        {
            var tabLinks = document.querySelectorAll(".tabs>dd>a");

            for(var i = 0; i < tabLinks.length; i++) { tabLinks[i].onclick = function(){return false; }}

            var showAllScenariosTab = document.querySelector("#showAllScenariosTab");
            var showKeptScenariosTab = document.querySelector("#showKeptScenariosTab");
            var showSeleniumCodeTab = document.querySelector("#showSeleniumCodeTab");

            var tabAllScenarios = document.querySelector("#tabAllScenarios");
            var tabKeptScenarios = document.querySelector("#tabKeptScenarios");
            var tabSeleniumCode = document.querySelector("#tabSeleniumCode");

            showAllScenariosTab.onclick = function()
            {
                this.className = "activeTab";
                showKeptScenariosTab.className = "";
                showSeleniumCodeTab.className = "";

                tabAllScenarios.className = "activeTab";
                tabKeptScenarios.className = "";
                tabSeleniumCode.className = "";
            };

            showKeptScenariosTab.onclick = function()
            {
                this.className = "activeTab";
                showAllScenariosTab.className = "";
                showSeleniumCodeTab.className = "";

                tabAllScenarios.className = "";
                tabKeptScenarios.className = "activeTab";
                tabSeleniumCode.className = "";
            };

            showSeleniumCodeTab.onclick = function()
            {
                this.className = "activeTab";
                showAllScenariosTab.className = "";
                showKeptScenariosTab.className = "";

                tabAllScenarios.className = "";
                tabKeptScenarios.className = "";
                tabSeleniumCode.className = "activeTab";
            };
        })();

        if(document.location.href.indexOf("start=now") != -1)
        {
            runButton.onclick();
        }
    </script>
</body>
</html>