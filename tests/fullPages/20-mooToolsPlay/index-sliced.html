<!DOCTYPE html>
<html>

<body>
    
    <div id="mainContentContainer"></div>
    <script>
  var Native = function(options)
  {
    var name = options.name;
    var legacy = options.legacy;
    var protect = options.protect;
    var initialize = options.initialize;
    if(options.afterImplement)
    {
      var afterImplement = options.afterImplement;
    }

    if(initialize)
    {
      var object = initialize;
    }

    if(legacy && initialize)
    {
      object.prototype = legacy.prototype;
    }

    if(name)
    {
      var family = name.toLowerCase();
      object.prototype.$family = {
        name: family
      };
    }

    var add = function(obj, name, method, force)
    {
      if(!protect || force || !(obj.prototype[name]))
      {
        obj.prototype[name] = method;
      }

      afterImplement.call(obj, name, method);
    };
    object.alias = function(a1, a2, a3)
    {
      if(typeof a1 == 'string')
      {
        var pa1 = this.prototype[a1];
        if(a1 = pa1)
        {
          var res = add(this, a2, a1, a3);
          return ;
        }
      }
    };
    object.implement = function(a1, a2, a3)
    {
      for(var p in a1)
      {
        add(this, p, a1[p], a2);
      }
    };
    return object;
  };
  Native.implement = function(objects, properties)
  {
    for(var i = 0, l = objects.length;i < l;i++)
    {
      objects[i].implement(properties);
    }
  };
  (function()
  {
    var natives = {
      'Array': Array, 
      'Function': Function, 
      'Number': Number, 
      'String': String
    };
    for(var n in natives)
    {
      new Native({
        name: n, 
        initialize: natives[n], 
        protect: true
      });
    }
  })();
  Array.alias('forEach', 'each');
  function $merge()
  {
    var args = Array.slice(arguments);
    args.unshift({});
    return $mixin.apply(null, args);
  }
  function $mixin(mix)
  {
    for(var i = 1, l = arguments.length;i < l;i++)
    {
      var object = arguments[i];
      for(var key in object)
      {
        var op = object[key], mp = mix[key];
        if(mp);
        else 
        {
          mix[key] = $unlink(op);
        }
      }
    }

    return mix;
  }
  function $pick()
  {
    for(var i = 0, l = arguments.length;i < l;i++)
    {
      if(arguments[i] != undefined)
      {
        return arguments[i];
      }
    }
  }
  function $type(obj)
  {
    if(obj == undefined)
    {
      return false;
    }

    if(obj.$family)
    {
      if(obj.$family.name == 'number' && !(isFinite(obj)))
      {
        return ;
      }
      else 
      {
        return obj.$family.name;
      }
    }

    return typeof obj;
  }
  function $unlink(object)
  {
    var unlinked;
    switch($type(object))
    {
      case 'object':
        unlinked = {};
        for(var p in object)
        {
          unlinked[p] = $unlink(object[p]);
        }

        break;
      case 'array':
        break;
      default:
        return object;
    }
    return unlinked;
  }
  var platformName;
  if(window.orientation != undefined);
  else 
  {
    platformName = (navigator.platform.match(/mac|win|linux/i))[0].toLowerCase();
  }

  var Browser = $merge({
    Engine: {name: 'unknown', version: 0}, 
    Platform: {
      name: platformName
    }, 
    Features: {
      xpath: !(!(document.evaluate)), 
      air: !(!(window.runtime)), 
      query: !(!(document.querySelector))
    }, 
    Plugins: {}, 
    Engines: {
      presto: function()
      {
        if(!(window.opera))
        {
          return false;
        }
      }, 
      trident: function()
      {
        if(!(window.ActiveXObject))
        {
          return false;
        }
      }, 
      webkit: function()
      {
        if(navigator.taintEnabled)
        {
          return false;
        }
      }, 
      gecko: function()
      {
        if(!(document.getBoxObjectFor) && window.mozInnerScreenX == null)
        {
          return ;
        }
        else 
        {
          if(document.getElementsByClassName)
          {
            return 19;
          }
        }
      }
    }
  }, Browser || {});
  Browser.detect = function()
  {
    for(var engine in this.Engines)
    {
      var version = this.Engines[engine]();
      if(version)
      {
        this.Engine = {};
        break;
      }
    }
  };
  Browser.detect();
  Native.UID = 1;
  var nonTridentFunction = function(item)
  {
    if(item.uid);
    else 
    {
      item.uid = Native.UID++;
    }
  };
  var $uid;
  if(Browser.Engine.trident);
  else 
  {
    $uid = nonTridentFunction;
  }

  var windowLegacy;
  if(!(Browser.Engine.trident))
  {
    windowLegacy = window.Window;
  }

  var Window = new Native({
    name: 'Window', 
    legacy: windowLegacy, 
    initialize: function(win)
    {
      $uid(win);
    }, 
    afterImplement: function(property, value)
    {
      window[property] = Window.Prototype[property] = value;
    }
  });
  Window.Prototype = {};
  new Window(window);
  var documentLegacy;
  if(!(Browser.Engine.trident))
  {
    documentLegacy = window.Document;
  }

  var Document = new Native({
    name: 'Document', 
    legacy: documentLegacy, 
    initialize: function(doc)
    {
      $uid(doc);
    }, 
    afterImplement: function(property, value)
    {
      document[property] = Document.Prototype[property] = value;
    }
  });
  Document.Prototype = {};
  new Document(document);
  Function.implement({
    extend: function(properties)
    {
      for(var property in properties)
      {
        this[property] = properties[property];
      }

      return this;
    }, 
    create: function(options)
    {
      var self = this;
      return function(event)
      {
        var args = options.arguments;
        if(args != undefined);
        else 
        {
          var optionsEvent;
          if(options.event);
          else 
          {
            optionsEvent = 0;
          }

          args = Array.slice(arguments, optionsEvent);
        }

        var returns = function()
        {
          var applyArg;
          if(options.bind)
          {
            applyArg = options.bind;
          }

          return self.apply(applyArg, args);
        };
        return returns();
      };
    }
  });
  function Class(params)
  {
    var newClass = (function()
    {}).extend(this);
    newClass.implement(params);
  }
  new Native({
    initialize: Class
  });
  Class.implement({
    implement: function(key, value)
    {
      if($type(key) == 'object')
      {
        for(var p in key)
        {
          this.implement(p, key[p]);
        }

        return ;
      }

      var proto = this.prototype;
      switch($type(value))
      {
        case 'function':
          break;
        case 'object':
          var previous = proto[key]
          if($type(previous) == 'object');
          else 
          {
            $unlink(value);
          }

          break;
        case 'array':
          $unlink(value);
          break;
      }
    }
  });
  var Chain = new Class({
    $chain: [], 
    chain: function()
    {}, 
    callChain: function()
    {}, 
    clearChain: function()
    {}
  });
  var Events = new Class({
    $events: {}, 
    addEvent: function(type, fn, internal)
    {}, 
    addEvents: function(events)
    {}, 
    fireEvent: function(type, args, delay)
    {}, 
    removeEvent: function(type, fn)
    {}, 
    removeEvents: function(events)
    {}
  });
  var Options = new Class({
    setOptions: function()
    {}
  });
  var Element = new Native({
    name: 'Element', 
    legacy: window.Element, 
    initialize: function(tag, props)
    {}, 
    afterImplement: function(key, value)
    {}
  });
  (function()
  {
    var storage = {};
    var get = function(uid)
    {
      var arg = storage[uid];
      if(!arg)
      {
        arg = storage[uid] = {};
      }

      return arg;
    };
    Native.implement([Element, Window, Document], {
      addListener: function(type, fn)
      {
        if(this.addEventListener)
        {
          this.addEventListener(type, fn, false);
        }
      }, 
      retrieve: function(property, dflt)
      {
        var storage = get(this.uid), prop = storage[property];
        if(dflt != undefined && prop == undefined)
        {
          prop = storage[property] = dflt;
        }

        return $pick(prop);
      }
    });
  })();
  Native.implement([Element, Window, Document], {
    addEvent: function(type, fn)
    {
      var events = this.retrieve('events', {});
      if(!(events[type]))
      {
        events[type] = {
          'keys': []
        };
      }

      events[type].keys.push(fn);
      var realType = type, self = this;
      var defn = function()
      {
        return fn.call(self);
      };
      var nativeEvent = Element.NativeEvents[realType];
      if(nativeEvent)
      {
        this.addListener(realType, defn);
      }
    }, 
    fireEvent: function(type, args, delay)
    {
      var events = this.retrieve('events');
      events[type].keys.each(function(fn)
      {
        fn.create({
          'bind': this
        })();
      }, this);
    }
  });
  Element.NativeEvents = {load: 1, DOMContentLoaded: 1};
  (function()
  {
    var domready = function()
    {
      if(Browser.loaded)
      {
        return ;
      }

      Browser.loaded = true;
      document.fireEvent('domready');
    };
    window.addEvent('load', domready);
    if(Browser.Engine.trident);
    else if(Browser.Engine.webkit);
    else 
    {
      document.addEvent('DOMContentLoaded', domready);
    }
  })();
</script>
    <script>
  document.addEvent('domready', function()
  {
    var contentContainer = document.getElementById('mainContentContainer');
    contentContainer.textContent += 'Hello from MooTools DOM ready';
  });
</script>

</body>
</html>