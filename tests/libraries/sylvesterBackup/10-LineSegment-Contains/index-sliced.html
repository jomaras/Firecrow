<!DOCTYPE html>
<html>
  <head>
    <script>
      var Sylvester = {precision: 0.000001};
      Sylvester.Vector = function ()
      {};
      Sylvester.Vector.create = function (elements)
      {
        var V = new Sylvester.Vector();
        return V.setElements(elements);
      };
      Sylvester.Vector.Zero = function (n)
      {
        var elements = [];
        while(n--);
        return Sylvester.Vector.create(elements);
      };
      Sylvester.Vector.prototype = {
        modulus: function ()
        {
          return Math.sqrt(this.dot(this));
        }, 
        eql: function (vector)
        {
          var n = this.elements.length;
          var V = vector.elements || vector;
          while(n--)
          {
            if(Math.abs(this.elements[n] - V[n]) > Sylvester.precision)
            {
              return false;
            }
          }

          return true;
        }, 
        dup: function ()
        {
          return Sylvester.Vector.create(this.elements);
        }, 
        map: function (fn, context)
        {
          var elements = [];
          return Sylvester.Vector.create(elements);
        }, 
        forEach: function (fn, context)
        {
          var n = this.elements.length;
          for(var i = 0;i < n;i++)
          {
            fn.call(context, this.elements[i], i + 1);
          }
        }, 
        angleFrom: function (vector)
        {
          var V = vector.elements;
          var n = this.elements.length;
          var dot = 0, mod1 = 0, mod2 = 0;
          this.each(function (x, i)
          {
            dot += x * V[i - 1];
            mod1 += x * x;
            mod2 += V[i - 1] * V[i - 1];
          });
          mod1 = Math.sqrt(mod1);
          mod2 = Math.sqrt(mod2);
          var theta = dot / (mod1 * mod2);
          return Math.acos(theta);
        }, 
        isAntiparallelTo: function (vector)
        {
          var angle = this.angleFrom(vector);
          return angle === null ? 0 : Math.abs(angle - Math.PI) <= Sylvester.precision;
        }, 
        subtract: function (vector)
        {
          var V = vector.elements;
          return this.map(function (x, i)
          {});
        }, 
        dot: function (vector)
        {
          var V = vector.elements;
          var product = 0, n = this.elements.length;
          while(n--)
          {
            product += this.elements[n] * V[n];
          }

          return product;
        }, 
        to3D: function ()
        {
          var V = this.dup();
          return V;
        }, 
        setElements: function (els)
        {
          this.elements = (els.elements || els).slice();
          return this;
        }
      };
      Sylvester.Vector.prototype.each = Sylvester.Vector.prototype.forEach;
      Sylvester.Vector.i = Sylvester.Vector.create([null, null, null]);
      Sylvester.Vector.j = Sylvester.Vector.create([null, null, null]);
      Sylvester.Vector.k = Sylvester.Vector.create([null, null, null]);
      Sylvester.Line = function ()
      {};
      Sylvester.Line.prototype = {
        setVectors: function (anchor, direction)
        {
          direction = Sylvester.Vector.create(direction);
          var mod = direction.modulus();
        }
      };
      Sylvester.Line.create = function (anchor, direction)
      {
        var L = new Sylvester.Line();
        return L.setVectors(anchor, direction);
      };
      Sylvester.Line.create(Sylvester.Vector.Zero(3), Sylvester.Vector.i);
      Sylvester.Line.create(Sylvester.Vector.Zero(3), Sylvester.Vector.j);
      Sylvester.Line.create(Sylvester.Vector.Zero(3), Sylvester.Vector.k);
      Sylvester.Line.Segment = function ()
      {};
      Sylvester.Line.Segment.prototype = {
        toVector: function ()
        {
          var A = this.start.elements, B = this.end.elements;
          return Sylvester.Vector.create([B[0] - A[0], B[1] - A[1], B[2] - A[2]]);
        }, 
        midpoint: function ()
        {
          var A = this.start.elements, B = this.end.elements;
          return Sylvester.Vector.create([(B[0] + A[0]) / 2, (B[1] + A[1]) / 2, (B[2] + A[2]) / 2]);
        }, 
        contains: function (obj)
        {
          if(obj.start && obj.end)
          {
            return this.contains(obj.start) && this.contains(obj.end);
          }

          var P = (obj.elements || obj).slice();
          if(this.start.eql(P))
          {
            return true;
          }

          var S = this.start.elements;
          var V = Sylvester.Vector.create([S[0] - P[0], S[1] - P[1], S[2] - P[2]]);
          var vect = this.toVector();
          return V.isAntiparallelTo(vect) && V.modulus() <= vect.modulus();
        }, 
        setPoints: function (startPoint, endPoint)
        {
          startPoint = Sylvester.Vector.create(startPoint).to3D();
          endPoint = Sylvester.Vector.create(endPoint).to3D();
          Sylvester.Line.create(startPoint, endPoint.subtract(startPoint));
          this.start = startPoint;
          this.end = endPoint;
          return this;
        }
      };
      Sylvester.Line.Segment.create = function (v1, v2)
      {
        var S = new Sylvester.Line.Segment();
        return S.setPoints(v1, v2);
      };
    </script>
  </head>
  <body>
    <script>
      var segment = Sylvester.Line.Segment.create([5, 5, 5], [10, 10, 10]);
      var segment2 = Sylvester.Line.Segment.create([1, 1, 0], [1, 2, 0]);
      var a1 = segment.contains(segment.midpoint());
      var a2 = segment.contains([5, 5, 5]);
      var a3 = segment.contains([10, 10, 10]);
      var a4 = !(segment.contains([4.9999, 4.9999, 4.9999]));
      var a5 = !(segment.contains([10.00001, 10.00001, 10.00001]));
      var a6 = segment.contains(Sylvester.Line.Segment.create([5, 5, 5], [8, 8, 8]));
      var a7 = segment.contains(Sylvester.Line.Segment.create([7, 7, 7], [10, 10, 10]));
      var a8 = !(segment.contains(Sylvester.Line.Segment.create([4, 4, 4], [8, 8, 8])));
      a1;
      a2;
      a3;
      a4;
      a5;
      a6;
      a7;
      a8;
    </script>
  </body>
</html>
