<!DOCTYPE html>
<html>
  <head>
    <script>
      var Sylvester = {precision: 0.000001};
      Sylvester.Vector = function ()
      {};
      Sylvester.Vector.create = function (elements)
      {
        var V = new Sylvester.Vector();
        return V.setElements(elements);
      };
      Sylvester.Vector.Zero = function (n)
      {
        var elements = [];
        while(n--)
        {
          elements.push(0);
        }

        return Sylvester.Vector.create(elements);
      };
      Sylvester.Vector.prototype = {
        modulus: function ()
        {
          return Math.sqrt(this.dot(this));
        }, 
        dup: function ()
        {
          return Sylvester.Vector.create(this.elements);
        }, 
        dot: function (vector)
        {
          var V = vector.elements;
          var product = 0, n = this.elements.length;
          while(n--)
          {
            product += this.elements[n] * V[n];
          }

          return product;
        }, 
        to3D: function ()
        {
          var V = this.dup();
          return V;
        }, 
        setElements: function (els)
        {
          this.elements = (els.elements || els).slice();
          return this;
        }
      };
      Sylvester.Vector.i = Sylvester.Vector.create([1, 0, 0]);
      Sylvester.Vector.j = Sylvester.Vector.create([null, null, null]);
      Sylvester.Vector.k = Sylvester.Vector.create([null, null, null]);
      Sylvester.Line = function ()
      {};
      Sylvester.Line.prototype = {
        distanceFrom: function (obj)
        {
          if(obj.direction)
          {
            var A;
          }
          else 
          {
            var P = obj.elements || obj;
            var A = this.anchor.elements, D = this.direction.elements;
            var PA1 = P[0] - A[0], PA2 = P[1] - A[1], PA3 = (P[2] || 0) - A[2];
            var modPA = Math.sqrt(((PA1 * PA1) + (PA2 * PA2)) + (PA3 * PA3));
            var cosTheta = (((PA1 * D[0]) + (PA2 * D[1])) + (PA3 * D[2])) / modPA;
            var sin2 = 1 - (cosTheta * cosTheta);
            return Math.abs(modPA * Math.sqrt(sin2 < 0 ? 0 : sin2));
          }
        }, 
        contains: function (obj)
        {
          if(obj.start && obj.end)
          {
            return this.contains(obj.start) && this.contains(obj.end);
          }

          var dist = this.distanceFrom(obj);
          return dist !== null && dist <= Sylvester.precision;
        }, 
        setVectors: function (anchor, direction)
        {
          anchor = Sylvester.Vector.create(anchor);
          direction = Sylvester.Vector.create(direction);
          var mod = direction.modulus();
          this.anchor = anchor;
          this.direction = Sylvester.Vector.create([direction.elements[0] / mod, direction.elements[1] / mod, direction.elements[2] / mod]);
          return this;
        }
      };
      Sylvester.Line.create = function (anchor, direction)
      {
        var L = new Sylvester.Line();
        return L.setVectors(anchor, direction);
      };
      var $L = Sylvester.Line.create;
      Sylvester.Line.X = Sylvester.Line.create(Sylvester.Vector.Zero(3), Sylvester.Vector.i);
      Sylvester.Line.create(Sylvester.Vector.Zero(3), Sylvester.Vector.j);
      Sylvester.Line.create(Sylvester.Vector.Zero(3), Sylvester.Vector.k);
      Sylvester.Line.Segment = function ()
      {};
      Sylvester.Line.Segment.prototype = {
        setPoints: function (startPoint, endPoint)
        {
          startPoint = Sylvester.Vector.create(startPoint).to3D();
          endPoint = Sylvester.Vector.create(endPoint).to3D();
          this.start = startPoint;
          this.end = endPoint;
          return this;
        }
      };
      Sylvester.Line.Segment.create = function (v1, v2)
      {
        var S = new Sylvester.Line.Segment();
        return S.setPoints(v1, v2);
      };
    </script>
  </head>
  <body>
    <script>
      var Line = Sylvester.Line;
      var a1 = Line.X.contains([99, 0, 0]);
      var a2 = !(Line.X.contains([99, 1, 0]));
      var a3 = !(Line.X.contains([99, 0, 2]));
      var a4 = $L([0, 0, 0], [1, 1, 1]).contains(Line.Segment.create([-2, -2, -2], [13, 13, 13]));
      a1;
      a2;
      a3;
      a4;
    </script>
  </body>
</html>
